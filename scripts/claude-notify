#!/bin/bash
# Claude Code Notify - Desktop notifications for Claude Code with tmux integration
# https://github.com/your-repo/claude-code-notify

# Capture tmux info while we have context
TMUX_SOCKET="$TMUX"
TMUX_TARGET=$(tmux display-message -p '#S:#I.#P')
TMUX_SESSION=$(tmux display-message -p '#S')
TMUX_WINDOW=$(tmux display-message -p '#I')
TMUX_PANE=$(tmux display-message -p '#P')
TMUX_WINDOW_NAME=$(tmux display-message -p '#S:#W')

# Send notification with action button
ACTION=$(dunstify -A "switch,Go to window" \
    "Claude Code - $TMUX_WINDOW_NAME" \
    "Waiting for your input" \
    -t 0)

# If user clicked the action, switch to the pane
if [ "$ACTION" = "switch" ]; then
    export TMUX="$TMUX_SOCKET"
    # Switch directly to session:window.pane in one command
    tmux switch-client -t "$TMUX_SESSION:$TMUX_WINDOW.$TMUX_PANE"
fi
